{"ast":null,"code":"import _defineProperty from \"/Users/justincoulston/Desktop/affilaite-core-mono/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/justincoulston/Desktop/affilaite-core-mono/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { deDupeArray, urlCase } from '@helpers/common';\nimport { SEARCH_PATH } from '@constants';\nexport function addUrlPart(name, value, partsArray) {\n  // remove any existing params for a given name to be overwritten\n  var parts = partsArray.filter(function (item) {\n    return item && !item.includes(name);\n  });\n  parts.push(\"\".concat(name, \"=\").concat(value));\n  return parts;\n}\nexport function addExistingUrlParts(productUrl, productUrlParams) {\n  if (!productUrl) return [];\n  var query = productUrlParams === null || productUrlParams === void 0 ? void 0 : productUrlParams.search;\n  return (query === null || query === void 0 ? void 0 : query.replace(/^\\?/, '').split('&')) || [];\n}\nexport function createUrlFilters(_ref, productUrl, isSearchPage) {\n  var priceSort = _ref.priceSort,\n      priceThresholdLow = _ref.priceThresholdLow,\n      priceThresholdHigh = _ref.priceThresholdHigh,\n      keyWords = _ref.keyWords,\n      saleThreshold = _ref.saleThreshold,\n      brands = _ref.brands,\n      section = _ref.section,\n      category = _ref.category;\n  var origin = window.location.origin;\n  var productUrlParams = new URL(\"\".concat(origin).concat(productUrl));\n  var productUrlPath = productUrlParams.pathname;\n  var queryJoiner = isSearchPage ? '?' : '';\n  var urlParts = addExistingUrlParts(productUrl, productUrlParams);\n\n  if (priceSort) {\n    urlParts = addUrlPart('price-sort', priceSort, urlParts);\n  }\n\n  if (priceThresholdLow) {\n    urlParts = addUrlPart('price-threshold-low', priceThresholdLow, urlParts);\n  }\n\n  if (priceThresholdHigh) {\n    urlParts = addUrlPart('price-threshold-high', priceThresholdHigh, urlParts);\n  }\n\n  if (keyWords !== null && keyWords !== void 0 && keyWords.length) {\n    urlParts = addUrlPart('key-words', keyWords.join(','), urlParts);\n  }\n\n  if (brands !== null && brands !== void 0 && brands.length) {\n    urlParts = addUrlPart('brands', brands.join(','), urlParts);\n  }\n\n  if (saleThreshold && parseInt(saleThreshold)) {\n    urlParts = addUrlPart('sale-threshold', saleThreshold, urlParts);\n  }\n\n  if (category !== null && category !== void 0 && category.length) {\n    urlParts = addUrlPart('category', category.join(','), urlParts);\n  }\n\n  if (section) {\n    urlParts = addUrlPart('section', section, urlParts);\n  }\n\n  var filterPath = urlParts.length ? \"\".concat(urlParts.join('&')) : '';\n  window.history.replaceState({}, null, \"\".concat(productUrlPath).concat(queryJoiner).concat(filterPath));\n}\nexport function normalizeFilters(_ref2, isSearchPage) {\n  var priceSort = _ref2.priceSort,\n      priceThreshold = _ref2.priceThreshold,\n      keyWords = _ref2.keyWords,\n      saleThreshold = _ref2.saleThreshold,\n      scaler = _ref2.scaler,\n      hasTouchedSlider = _ref2.hasTouchedSlider,\n      brands = _ref2.brands,\n      section = _ref2.section,\n      category = _ref2.category;\n\n  var _priceThreshold = _slicedToArray(priceThreshold, 2),\n      min = _priceThreshold[0],\n      max = _priceThreshold[1];\n\n  var isMinSetting = min === 0;\n  var isMaxSetting = max === 100;\n  var minPrice = hasTouchedSlider && !isMinSetting ? min * scaler : null;\n  var maxPrice = hasTouchedSlider && !isMaxSetting ? max * scaler : null;\n  var searchSpecificFilters = isSearchPage ? {\n    section: section,\n    category: category !== null && category !== void 0 && category.length ? category : null\n  } : {};\n  return _objectSpread({\n    priceThresholdLow: minPrice,\n    priceThresholdHigh: maxPrice,\n    priceSort: priceSort === 'recommended' ? null : priceSort,\n    keyWords: keyWords !== null && keyWords !== void 0 && keyWords.length ? keyWords : null,\n    brands: brands !== null && brands !== void 0 && brands.length ? brands : null,\n    saleThreshold: parseInt(saleThreshold)\n  }, searchSpecificFilters);\n}\nexport function getNumberOfFiltersSelected(filters) {\n  return Object.keys(filters).filter(function (key) {\n    var filterValue = filters[key];\n    return !!filterValue && filterValue !== 'recommended';\n  }).length;\n} // TODO: this helper is not fully \"white labeled\" given we are looking at the first item in the \"subNav\"\n// array. For different \"labels\", this will have to be rewritten\n\nexport function getCategoryFilters(section, categoryData) {\n  if (!categoryData) return [];\n\n  if (section) {\n    var _sectionData$subNav$;\n\n    var sectionData = categoryData.find(function (sec) {\n      return sec.title === section;\n    });\n    return (sectionData === null || sectionData === void 0 ? void 0 : (_sectionData$subNav$ = sectionData.subNav[0]) === null || _sectionData$subNav$ === void 0 ? void 0 : _sectionData$subNav$.subNavItems.map(function (item) {\n      return item.title;\n    })) || [];\n  } else {\n    var allItems = categoryData === null || categoryData === void 0 ? void 0 : categoryData.map(function (sec) {\n      var _sec$subNav$;\n\n      return (sec === null || sec === void 0 ? void 0 : sec.subNav) && (sec === null || sec === void 0 ? void 0 : (_sec$subNav$ = sec.subNav[0]) === null || _sec$subNav$ === void 0 ? void 0 : _sec$subNav$.subNavItems.map(function (item) {\n        return item.title;\n      }));\n    });\n    return deDupeArray((allItems === null || allItems === void 0 ? void 0 : allItems.flat()) || []);\n  }\n}\nexport function getSectionFilters(section, categoryData) {\n  return (categoryData === null || categoryData === void 0 ? void 0 : categoryData.map(function (sec) {\n    return sec.title;\n  })) || [];\n}\nexport function sortSelectedCheckboxes(fullList, selectedList) {\n  return fullList.sort(function (item) {\n    if (selectedList.includes(urlCase(item))) {\n      return -1;\n    }\n  });\n}\nexport function isSearch(router) {\n  return router.pathname.includes(SEARCH_PATH);\n}","map":null,"metadata":{},"sourceType":"module"}