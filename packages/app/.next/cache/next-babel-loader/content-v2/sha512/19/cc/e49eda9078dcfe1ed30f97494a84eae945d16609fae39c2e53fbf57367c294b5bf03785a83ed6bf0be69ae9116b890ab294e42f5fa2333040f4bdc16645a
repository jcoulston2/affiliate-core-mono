{"ast":null,"code":"import _toConsumableArray from \"/Users/justincoulston/Desktop/affilaite-core-mono/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { urlCase, isServer } from '@helpers/common';\nexport function structureNavigationData(sectionItem) {\n  return sectionItem.data.map(function (_ref) {\n    var label = _ref.label;\n    return {\n      title: label,\n      subNavItems: sectionItem.data.filter(function (catlevel) {\n        return catlevel.label === label;\n      }).map(function (_ref2) {\n        var category = _ref2.category;\n        return {\n          title: category,\n          link: urlCase(\"/\".concat(sectionItem.section, \"/\").concat(category))\n        };\n      })\n    };\n  });\n}\nexport function normalizeNavigationData(structuredCatLevelData) {\n  return structuredCatLevelData.reduce(function (acc, current) {\n    return [].concat(_toConsumableArray(acc), [acc && acc.some(function (has) {\n      return has.title === current.title;\n    }) ? null : current]);\n  }, []).filter(function (notNull) {\n    return notNull;\n  });\n}\nexport function getNavigationProps(rawApiResponse) {\n  if (!rawApiResponse) return null;\n  var affiliateData = rawApiResponse.affiliateData;\n  var normalizedNavData = affiliateData.map(function (sectionItem) {\n    var structuredCatLevelData = structureNavigationData(sectionItem);\n    var normalizedCatLevelData = normalizeNavigationData(structuredCatLevelData);\n    return {\n      title: sectionItem.section,\n      link: \"/\".concat(sectionItem.section),\n      subNav: normalizedCatLevelData\n    };\n  });\n  return {\n    affiliateData: normalizedNavData\n  };\n}\nexport function pushState(state, title, url) {\n  var _window$history;\n\n  if ((_window$history = window.history) !== null && _window$history !== void 0 && _window$history.pushState) {\n    window.history.pushState(state, state, url);\n  }\n}\nvar pushDefault = !isServer() && window.onpopstate;\nexport function defatulPopState() {\n  if (!isServer() && window.onpopstate) {\n    window.onpopstate = pushDefault;\n  }\n}\nexport function fixPopState() {\n  if (!isServer() && window.history && window.onpopstate) {\n    window.history.pushState(null, null, location.href);\n    window.history.back();\n    window.history.forward();\n\n    window.onpopstate = function () {\n      history.go(1);\n    };\n  }\n}","map":{"version":3,"sources":["/Users/justincoulston/Desktop/affilaite-core-mono/packages/affiliate-app/helpers/page/page.js"],"names":["urlCase","isServer","structureNavigationData","sectionItem","data","map","label","title","subNavItems","filter","catlevel","category","link","section","normalizeNavigationData","structuredCatLevelData","reduce","acc","current","some","has","notNull","getNavigationProps","rawApiResponse","affiliateData","normalizedNavData","normalizedCatLevelData","subNav","pushState","state","url","window","history","pushDefault","onpopstate","defatulPopState","fixPopState","location","href","back","forward","go"],"mappings":"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","sourcesContent":["//@flow\nimport { type NavigationApiQuery, type NavigationDataItem } from '../../types/apiQueries';\nimport {\n  type NormalizedNavigationData,\n  type NormalizedSubNavData,\n} from '../../types/navigationData';\nimport { urlCase, isServer } from '@helpers/common';\n\nexport function structureNavigationData(sectionItem: NavigationDataItem): NormalizedSubNavData {\n  return sectionItem.data.map(({ label }) => {\n    return {\n      title: label,\n      subNavItems: sectionItem.data\n        .filter((catlevel) => catlevel.label === label)\n        .map(({ category }) => ({\n          title: category,\n          link: urlCase(`/${sectionItem.section}/${category}`),\n        })),\n    };\n  });\n}\n\nexport function normalizeNavigationData(\n  structuredCatLevelData: NormalizedSubNavData\n): NormalizedSubNavData {\n  return structuredCatLevelData\n    .reduce((acc, current): any => {\n      return [...acc, acc && acc.some((has) => has.title === current.title) ? null : current];\n    }, [])\n    .filter((notNull) => notNull);\n}\n\nexport function getNavigationProps(rawApiResponse: NavigationApiQuery): NormalizedNavigationData {\n  if (!rawApiResponse) return null;\n\n  const { affiliateData } = rawApiResponse;\n  const normalizedNavData = affiliateData.map((sectionItem) => {\n    const structuredCatLevelData = structureNavigationData(sectionItem);\n    const normalizedCatLevelData = normalizeNavigationData(structuredCatLevelData);\n\n    return {\n      title: sectionItem.section,\n      link: `/${sectionItem.section}`,\n      subNav: normalizedCatLevelData,\n    };\n  });\n\n  return {\n    affiliateData: normalizedNavData,\n  };\n}\n\nexport function pushState(state: { [string]: any }, title: string, url: string): void {\n  if (window.history?.pushState) {\n    window.history.pushState(state, state, url);\n  }\n}\n\nconst pushDefault = !isServer() && window.onpopstate;\nexport function defatulPopState(): void {\n  if (!isServer() && window.onpopstate) {\n    window.onpopstate = pushDefault;\n  }\n}\n\nexport function fixPopState(): void {\n  if (!isServer() && window.history && window.onpopstate) {\n    window.history.pushState(null, null, location.href);\n    window.history.back();\n    window.history.forward();\n    window.onpopstate = function () {\n      history.go(1);\n    };\n  }\n}\n"]},"metadata":{},"sourceType":"module"}