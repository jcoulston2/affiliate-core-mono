{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from 'react';\nimport { normalizeFilters } from '@modules/Filters/helper';\nimport { useCms } from '@hooks';\nimport { toArrayNullable, stringifySafe } from '@helpers/common';\nimport { useRouter } from 'next/router';\nimport { isSearch } from './helper';\nexport default function useFilters(defaults) {\n  const router = useRouter();\n  const isSearchPage = isSearch(router);\n  const {\n    productFiltersContent\n  } = useCms('listingContent');\n  const {\n    sliderPriceScaleMultiplier: scaler\n  } = productFiltersContent;\n  const {\n    0: filterDrawOpen,\n    1: setFilterDrawOpen\n  } = useState(false);\n  const {\n    0: priceSort,\n    1: setPriceSort\n  } = useState('recommended');\n  const {\n    0: keyWords,\n    1: setKeyWords\n  } = useState([]);\n  const {\n    0: saleThreshold,\n    1: setSaleThreshold\n  } = useState(null);\n  const {\n    0: hasTouchedSlider,\n    1: setHasTouchedSlider\n  } = useState(null);\n  const {\n    0: filterRefresh,\n    1: triggerFilterRefresh\n  } = useState(false);\n  const {\n    0: priceThreshold,\n    1: setPriceThreshold\n  } = useState([0, 100]);\n  const {\n    0: brands,\n    1: setBrands\n  } = useState([]);\n  const {\n    0: category,\n    1: setCategory\n  } = useState([]);\n  const {\n    0: section,\n    1: setSection\n  } = useState(null);\n\n  const setDefaultFilters = () => {\n    if (!defaults) return;\n    setHasTouchedSlider(!!(defaults.priceThresholdLow || defaults.priceThresholdHigh));\n    setPriceSort(defaults.priceSort || 'recommended');\n    setKeyWords(toArrayNullable(defaults.keyWords) || []);\n    setSaleThreshold(stringifySafe(defaults.saleThreshold));\n    setBrands(toArrayNullable(defaults.brands) || []);\n    setCategory(toArrayNullable(defaults.category) || []);\n    setSection(defaults.section || null);\n    setPriceThreshold([parseInt(defaults.priceThresholdLow) / scaler || 0, parseInt(defaults.priceThresholdHigh) / scaler || 100]);\n  };\n\n  useEffect(() => {\n    setDefaultFilters();\n  }, [defaults]);\n  const searchFilters = isSearchPage ? {\n    category,\n    section\n  } : {};\n  const filterMethods = {\n    setPriceSort,\n    setPriceThreshold,\n    setKeyWords,\n    setSaleThreshold,\n    setFilterDrawOpen,\n    setHasTouchedSlider,\n    triggerFilterRefresh,\n    setBrands,\n    setCategory,\n    setSection\n  };\n\n  const filterState = _objectSpread({\n    filterDrawOpen,\n    priceSort,\n    keyWords,\n    saleThreshold,\n    hasTouchedSlider,\n    filterRefresh,\n    priceThreshold,\n    brands\n  }, searchFilters);\n\n  const normalizedFilters = normalizeFilters(_objectSpread({\n    priceSort,\n    priceThreshold,\n    keyWords,\n    saleThreshold,\n    scaler,\n    hasTouchedSlider,\n    brands\n  }, searchFilters), isSearchPage);\n  return {\n    filterMethods,\n    filterState,\n    normalizedFilters\n  };\n}","map":{"version":3,"sources":["/Users/justincoulston/Desktop/affilaite-core-mono/packages/affiliate-app/components/modules/Filters/hook.js"],"names":["useState","useEffect","normalizeFilters","useCms","toArrayNullable","stringifySafe","useRouter","isSearch","useFilters","defaults","router","isSearchPage","productFiltersContent","sliderPriceScaleMultiplier","scaler","filterDrawOpen","setFilterDrawOpen","priceSort","setPriceSort","keyWords","setKeyWords","saleThreshold","setSaleThreshold","hasTouchedSlider","setHasTouchedSlider","filterRefresh","triggerFilterRefresh","priceThreshold","setPriceThreshold","brands","setBrands","category","setCategory","section","setSection","setDefaultFilters","priceThresholdLow","priceThresholdHigh","parseInt","searchFilters","filterMethods","filterState","normalizedFilters"],"mappings":"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","sourcesContent":["//@flow\nimport { useState, useEffect } from 'react';\nimport { normalizeFilters } from '@modules/Filters/helper';\nimport { type NormalizeFiltersOutput } from './types';\nimport { useCms } from '@hooks';\nimport { type Filters as FilterType } from '@types/product';\nimport { toArrayNullable, stringifySafe } from '@helpers/common';\nimport { useRouter } from 'next/router';\nimport { isSearch } from './helper';\n\nexport type UseFilters = {\n  filterMethods: { [string]: Function },\n  filterState: {\n    priceSort: string,\n    keyWords: Array<string>,\n    saleThreshold: number,\n    priceThreshold: Array<number>,\n    filterDrawOpen: boolean,\n    hasTouchedSlider: boolean,\n    filterRefresh: boolean,\n    brands: Array<string>,\n  },\n  normalizedFilters: NormalizeFiltersOutput,\n};\n\nexport default function useFilters(defaults: ?FilterType): UseFilters {\n  const router = useRouter();\n  const isSearchPage = isSearch(router);\n  const { productFiltersContent } = useCms('listingContent');\n  const { sliderPriceScaleMultiplier: scaler } = productFiltersContent;\n  const [filterDrawOpen, setFilterDrawOpen] = useState<any>(false);\n  const [priceSort, setPriceSort] = useState<any>('recommended');\n  const [keyWords, setKeyWords] = useState<any>([]);\n  const [saleThreshold, setSaleThreshold] = useState<any>(null);\n  const [hasTouchedSlider, setHasTouchedSlider] = useState<any>(null);\n  const [filterRefresh, triggerFilterRefresh] = useState<any>(false);\n  const [priceThreshold, setPriceThreshold] = useState<any>([0, 100]);\n  const [brands, setBrands] = useState<any>([]);\n  const [category, setCategory] = useState<any>([]);\n  const [section, setSection] = useState<any>(null);\n\n  const setDefaultFilters = (): void => {\n    if (!defaults) return;\n    setHasTouchedSlider(!!(defaults.priceThresholdLow || defaults.priceThresholdHigh));\n    setPriceSort(defaults.priceSort || 'recommended');\n    setKeyWords(toArrayNullable(defaults.keyWords) || []);\n    setSaleThreshold(stringifySafe(defaults.saleThreshold));\n    setBrands(toArrayNullable(defaults.brands) || []);\n    setCategory(toArrayNullable(defaults.category) || []);\n    setSection(defaults.section || null);\n    setPriceThreshold([\n      parseInt(defaults.priceThresholdLow) / scaler || 0,\n      parseInt(defaults.priceThresholdHigh) / scaler || 100,\n    ]);\n  };\n\n  useEffect(() => {\n    setDefaultFilters();\n  }, [defaults]);\n\n  const searchFilters = isSearchPage ? { category, section } : {};\n  const filterMethods = {\n    setPriceSort,\n    setPriceThreshold,\n    setKeyWords,\n    setSaleThreshold,\n    setFilterDrawOpen,\n    setHasTouchedSlider,\n    triggerFilterRefresh,\n    setBrands,\n    setCategory,\n    setSection,\n  };\n\n  const filterState = {\n    filterDrawOpen,\n    priceSort,\n    keyWords,\n    saleThreshold,\n    hasTouchedSlider,\n    filterRefresh,\n    priceThreshold,\n    brands,\n    ...searchFilters,\n  };\n\n  const normalizedFilters: NormalizeFiltersOutput = normalizeFilters(\n    {\n      priceSort,\n      priceThreshold,\n      keyWords,\n      saleThreshold,\n      scaler,\n      hasTouchedSlider,\n      brands,\n      ...searchFilters,\n    },\n    isSearchPage\n  );\n\n  return {\n    filterMethods,\n    filterState,\n    normalizedFilters,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}